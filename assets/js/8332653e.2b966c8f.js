"use strict";(self.webpackChunkdocusaurus_classic_typescript=self.webpackChunkdocusaurus_classic_typescript||[]).push([[1277],{8879:(e,r,t)=>{t.r(r),t.d(r,{assets:()=>l,contentTitle:()=>o,default:()=>u,frontMatter:()=>i,metadata:()=>p,toc:()=>s});var n=t(11),a=(t(2735),t(9530));const i={},o="Iframe-based rendering",p={unversionedId:"architecture/browser-iframe-rendering",id:"architecture/browser-iframe-rendering",title:"Iframe-based rendering",description:"All the PHPRequestHandler responses must be rendered in an iframe to avoid reloading the page. Remember, the entire setup only lives as long as the main index.html. We want to avoid reloading the main app at all cost.",source:"@site/docs/11-architecture/10-browser-iframe-rendering.md",sourceDirName:"11-architecture",slug:"/architecture/browser-iframe-rendering",permalink:"/wordpress-playground/docs/architecture/browser-iframe-rendering",draft:!1,editUrl:"https://github.com/WordPress/wordpress-playground/tree/trunk/packages/docs/site/docs/11-architecture/10-browser-iframe-rendering.md",tags:[],version:"current",sidebarPosition:10,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Browser tab orchestrates the execution",permalink:"/wordpress-playground/docs/architecture/browser-tab-orchestrates-execution"},next:{title:"PHP Worker Threads",permalink:"/wordpress-playground/docs/architecture/browser-php-worker-threads"}},l={},s=[{value:"Iframes caveats",id:"iframes-caveats",level:2}],c={toc:s},d="wrapper";function u(e){let{components:r,...t}=e;return(0,a.kt)(d,(0,n.Z)({},c,t,{components:r,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"iframe-based-rendering"},"Iframe-based rendering"),(0,a.kt)("p",null,"All the PHPRequestHandler responses must be rendered in an iframe to avoid reloading the page. Remember, the entire setup only lives as long as the main ",(0,a.kt)("inlineCode",{parentName:"p"},"index.html"),". We want to avoid reloading the main app at all cost."),(0,a.kt)("p",null,"In our app example above, ",(0,a.kt)("inlineCode",{parentName:"p"},"index.php")," renders the following HTML:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-html"},'<a href="page.php">Go to page.php</a>\n')),(0,a.kt)("p",null,"Imagine our ",(0,a.kt)("inlineCode",{parentName:"p"},"index.html")," rendered it in a ",(0,a.kt)("inlineCode",{parentName:"p"},"<div>")," instead of an ",(0,a.kt)("inlineCode",{parentName:"p"},"<iframe>"),". As soon as you clicked on that link, the browser would try to navigate from ",(0,a.kt)("inlineCode",{parentName:"p"},"index.html")," to ",(0,a.kt)("inlineCode",{parentName:"p"},"page.php"),". However, ",(0,a.kt)("inlineCode",{parentName:"p"},"index.html")," runs the entire PHP app including the Worker Thread, the PHPRequestHandler, and the traffic control connecting them to the Service Worker. Navigating away from it would destroy the app."),(0,a.kt)("p",null,"Now, consider an iframe with the same link in it:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-html"},"<iframe srcdoc='<a href=\"page.php\">Go to page.php</a>'></iframe>\n")),(0,a.kt)("p",null,"This time, clicking the link the browser to load ",(0,a.kt)("inlineCode",{parentName:"p"},"page.php")," ",(0,a.kt)("strong",{parentName:"p"},"inside the iframe"),". The top-level index.html where the PHP application runs remains unaffected. This is why iframes are a crucial part of the ",(0,a.kt)("inlineCode",{parentName:"p"},"@php-wasm/web")," setup."),(0,a.kt)("h2",{id:"iframes-caveats"},"Iframes caveats"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},'target="_top"')," isn't handled yet. This means that clicking on ",(0,a.kt)("inlineCode",{parentName:"li"},'<a target="_top">Click here</a>')," will reload the main browser tab."),(0,a.kt)("li",{parentName:"ul"},"JavaScript popup windows originating in the iframe may not work correctly yet.")))}u.isMDXComponent=!0},9530:(e,r,t)=>{t.d(r,{Zo:()=>c,kt:()=>h});var n=t(2735);function a(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function i(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function o(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?i(Object(t),!0).forEach((function(r){a(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function p(e,r){if(null==e)return{};var t,n,a=function(e,r){if(null==e)return{};var t,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)t=i[n],r.indexOf(t)>=0||(a[t]=e[t]);return a}(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)t=i[n],r.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var l=n.createContext({}),s=function(e){var r=n.useContext(l),t=r;return e&&(t="function"==typeof e?e(r):o(o({},r),e)),t},c=function(e){var r=s(e.components);return n.createElement(l.Provider,{value:r},e.children)},d="mdxType",u={inlineCode:"code",wrapper:function(e){var r=e.children;return n.createElement(n.Fragment,{},r)}},m=n.forwardRef((function(e,r){var t=e.components,a=e.mdxType,i=e.originalType,l=e.parentName,c=p(e,["components","mdxType","originalType","parentName"]),d=s(t),m=a,h=d["".concat(l,".").concat(m)]||d[m]||u[m]||i;return t?n.createElement(h,o(o({ref:r},c),{},{components:t})):n.createElement(h,o({ref:r},c))}));function h(e,r){var t=arguments,a=r&&r.mdxType;if("string"==typeof e||a){var i=t.length,o=new Array(i);o[0]=m;var p={};for(var l in r)hasOwnProperty.call(r,l)&&(p[l]=r[l]);p.originalType=e,p[d]="string"==typeof e?e:a,o[1]=p;for(var s=2;s<i;s++)o[s]=t[s];return n.createElement.apply(null,o)}return n.createElement.apply(null,t)}m.displayName="MDXCreateElement"}}]);